<!DOCTYPE html>
<html>
<head>
    <title>Expense Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="container mt-4">
    <h1>Monthly Expense Tracker</h1>
    <a href="{{ url_for('add_expense') }}" class="btn btn-primary mb-3">Add Expense</a>

    <h3>All Expenses</h3>
    <table class="table table-bordered">
        <tr>
            <th>Date</th>
            <th>Category</th>
            <th>Description</th>
            <th>Amount</th>
            <th>Action</th>
        </tr>
        {% for exp in expenses %}
        <tr>
            <td>{{ exp.date.strftime('%Y-%m-%d') }}</td>
            <td>{{ exp.category }}</td>
            <td>{{ exp.description }}</td>
            <td>{{ exp.amount }}</td>
            <td><a href="{{ url_for('delete_expense', id=exp.id) }}" class="btn btn-danger btn-sm">Delete</a></td>
        </tr>
        {% endfor %}
    </table>

    <h3>Monthly Summary</h3>
    <canvas id="monthlyChart" width="400" height="200"></canvas>

    <h3>Category Summary</h3>
    <canvas id="categoryChart" width="400" height="200"></canvas>

    <script>
        const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
        const monthlyChart = new Chart(monthlyCtx, {
            type: 'bar',
            data: {
                labels: {{ summary.keys()|list }},
                datasets: [{ label: 'Total Spending', data: {{ summary.values()|list }}, backgroundColor: 'rgba(54, 162, 235, 0.6)' }]
            }
        });

        const categoryCtx = document.getElementById('categoryChart').getContext('2d');
        const categoryChart = new Chart(categoryCtx, {
            type: 'pie',
            data: {
                labels: {{ categories.keys()|list }},
                datasets: [{ data: {{ categories.values()|list }}, backgroundColor: ['rgba(255, 99, 132, 0.6)','rgba(54, 162, 235, 0.6)','rgba(255, 206, 86, 0.6)','rgba(75, 192, 192, 0.6)','rgba(153, 102, 255, 0.6)'] }]
            }
        });
    </script>
</body>
</html>

